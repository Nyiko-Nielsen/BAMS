<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="{{ url_for('static', filename='css/home.css') }}">
<link rel="icon" type="image/x-icon" href="../static/pics/Venture bliss-05.jpg ">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<style>/* styling the file upload form*/
  .form1 {
    border: 4px solid green;
    border-radius: 12px;
    padding: 55px;
    margin: 100px;
    background-color: white;
    }
    /*spinning loader*/
    .loader {
  border: 16px solid #f3f3f3; /* Light grey */
  border-top: 16px solid #3498db; /* Blue */
  border-radius: 50%;
  width: 20px;
  height: 20px;
  animation: spin 2s linear infinite;
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

    </style>
</head>
<header>
 <div style="background-color:	#ffffff;"> 
 <img src="{{url_for('static', filename='pics/Venture bliss-05.jpg')}}" height="220px" >  
 </div> 
<div class="navbar">
  <a href="{{ url_for('home') }}">Home</a>
   
  
   
  <a href="{{ url_for('dashboard') }}">Dashboard</a>
   
   <a href=" ">Visit</a>
    <a href="{{ url_for('logout') }}" style="margin-left: 20%;">Logout</a>
    <a></a><strong style="color:rgb(5, 114, 76);">|  Logged in : {{ email}}</strong></a>
</div>

{% with messages = get_flashed_messages(with_categories=true) %} {% if
  messages %} {% for category, message in messages %} {% if category ==
  'error' %}
  <div class="alert alert-warning">
    
     
      <span class="closebtn" onclick="this.parentElement.style.display='none';" >&times;</span>
     <strong> Danger!</strong>{{ message }}
  </div>
  {% else %}
  <div class="alert alert-success">
     
    <span class="closebtn" onclick="this.parentElement.style.display='none';" >&times;</span>
     <strong>Success!</strong>{{ message }}
  </div>
  {% endif %} {% endfor %} {% endif %} {% endwith %}
</header>
<body>
<div >
  <form action="/upload" method="POST" class="form1" enctype="multipart/form-data">
    <div class="loader"></div>
    <label for="myfile">Select excel file:</label>
    <input type="file" id="myfile" name="myfile">
    <br>
    <br>
    <input  id="execute-button" class="button" type="submit" value="import file" />
  </form> 
</div>
<script>
  $(document).ready(function() {
    $('.loader').hide(); // Initially hide the loader
    
    // Function to execute when the button is clicked
    function executeFunction() {
      $('.loader').show(); // Show the loader
      $.ajax({
        type: 'POST' ,
        url: '/upload',
        success: function(response) {
          $('.loader').hide(); // Hide the loader after the function execution
        }
      });
    }
    
    // Bind the button click event to execute the function
    $('#execute-button').click(executeFunction);
  });
</script>
<script>
  var timeout;

  function resetSessionTimeout() {
      clearTimeout(timeout);
      timeout = setTimeout(function() {
          window.location.href = '{{ url_for("logout") }}';
      }, 1800000);  // 30 minutes in milliseconds
  }

  // Bind the resetSessionTimeout function to various user interactions
  window.onload = resetSessionTimeout;
  document.onmousemove = resetSessionTimeout;
  document.onkeydown = resetSessionTimeout;
  document.onclick = resetSessionTimeout;
  document.onscroll = resetSessionTimeout;
</script>
</body>

</html>

